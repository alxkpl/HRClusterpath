<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Clusterpath algorithm for Hüsler-Reiss models — hr-clusterpath • HRClusterpath</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clusterpath algorithm for Hüsler-Reiss models — hr-clusterpath"><meta name="description" content="Gradient descent based on the Clusterpath algorithm adapted to the likelihood
of a graphical Hüsler-Reiss model. Usefull when the precision matrix \(\Theta\)
(or the variogram \(\Gamma\)) has a block matrix structure."><meta property="og:description" content="Gradient descent based on the Clusterpath algorithm adapted to the likelihood
of a graphical Hüsler-Reiss model. Usefull when the precision matrix \(\Theta\)
(or the variogram \(\Gamma\)) has a block matrix structure."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HRClusterpath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clusterpath algorithm for Hüsler-Reiss models</h1>

      <div class="d-none name"><code>hr-clusterpath.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Gradient descent based on the Clusterpath algorithm adapted to the likelihood
of a graphical Hüsler-Reiss model. Usefull when the precision matrix \(\Theta\)
(or the variogram \(\Gamma\)) has a block matrix structure.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_cluster</span><span class="op">(</span><span class="va">gamma</span>, <span class="va">weights</span>, <span class="va">eps_f</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">HR_Clusterpath</span><span class="op">(</span><span class="va">data</span>, <span class="va">zeta</span>, <span class="va">lambda</span>, eps_g <span class="op">=</span> <span class="fl">0.001</span>, eps_f <span class="op">=</span> <span class="fl">0.01</span>, it_max <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>For <code>get_clusters()</code>, a \(d \times d\) matrix : the variogram matrix \(\Gamma\).</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>For <code>get_clusters()</code>, the \(d \times d\) symmetric weightsmatrix with a zero diagonal.</p></dd>


<dt id="arg-eps-f">eps_f<a class="anchor" aria-label="anchor" href="#arg-eps-f"></a></dt>
<dd><p>A positive number : tolerance threshold for merging clusters.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>For <code>HR_Clusterapth()</code>, a \(n \times d\) matrix : the matrix of data.</p></dd>


<dt id="arg-zeta">zeta<a class="anchor" aria-label="anchor" href="#arg-zeta"></a></dt>
<dd><p>For <code>HR_Clusterapth()</code>, a positive number : tuned parameter for the exponential weights.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>For <code>get_clusters()</code>, a positive number : the weight of the penalty.</p>
<p>For <code>HR_Clusterpath()</code>, a numerix vector of positive number : the grid line for \(\lambda\).</p></dd>


<dt id="arg-eps-g">eps_g<a class="anchor" aria-label="anchor" href="#arg-eps-g"></a></dt>
<dd><p>A positive number : tolerance threshold for the convergence of the gradient descent.</p></dd>


<dt id="arg-it-max">it_max<a class="anchor" aria-label="anchor" href="#arg-it-max"></a></dt>
<dd><p>An integer : maximal number of iteration of the gradient descent algorithm.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>HR_Clusterpath()</code> is a gradient descent from the data with default values and method for
the optimization : the variogram matrix \(\Gamma\) is the empirical variogram and the weights are
set as the exponential weights, which depends of only one tuning parameter \(\zeta\) and where
we have some theoretical results.</p>
<p><code>get_clusters()</code> is a freer version of the previous function. You can use your own estimation for the
variogram \(\Gamma\) and customizable weights with the matrix \(W\).</p>
<p>Both of them produce a list of results :</p><ul><li><p>$R : the \(R\) matrix of the clusters.</p></li>
<li><p>$clusters : a list of the variable indices, clustered.</p></li>
<li><p>$nllh : the value of the negative penalised negative loglikelihood.</p></li>
<li><p>$lambda : the value of lambda.</p></li>
</ul><p>In the case of <code>HR_Clusterpath()</code> it is a list of the previous list.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The block matrix models is defined from two elements : the cluster's partition
\(\{C_1, \dots, C_K\}\), included in \(V\) and the \(R\) matrix which belongs
to \(\mathcal S_K(\mathbb R)\), the set of symmetric \(K \times K\) matrix (See also
<code><a href="build_theta.html">build_theta</a>()</code> and <code><a href="extract_R_matrix.html">extract_R_matrix</a>()</code>).</p>
<p>The Clusterpath aims to find optimum of some penalised negative loglikelihood defined in
<code><a href="neg_likelihood_pen.html">neg_likelihood_pen</a>()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="some-results-for-hr-clusterpath-">Some results for <code>HR_Clusterpath()</code><a class="anchor" aria-label="anchor" href="#some-results-for-hr-clusterpath-"></a></h2>



<p>When we get replications \(X_1, \dots, X_n\) of a random vector \(X\) which
belongs to the attraction domain of a \(K\)-block Hüsler-Reiss graphical model, the
minimum of the penalised negative loglikelihood conveges almost surely to the
true precision matrix of the model \(\Theta^*\), for all \(\lambda\), provided that
we choose a sequence \((\zeta_n)_{n\in \mathbb N^*}\) which grows slower than the
\(log(n)\) sequence. In general, the \(\zeta \in [1,2]\) is a good choice.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, nc <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu">generate_random_Gamma</span><span class="op">(</span>d <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in generate_random_Gamma(d = 4):</span> could not find function "generate_random_Gamma"</span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>              <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, nc <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Cluster_HR</span> <span class="op">&lt;-</span> <span class="fu">get_cluster</span><span class="op">(</span><span class="va">gamma</span>, <span class="va">W</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">Cluster_HR</span><span class="op">(</span><span class="va">R</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in Cluster_HR(R):</span> argument "lambda" is missing, with no default</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexandre CAPEL.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

