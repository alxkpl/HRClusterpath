<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Clusterpath algorithm for Hüsler-Reiss models — hr-clusterpath • HRClusterpath</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clusterpath algorithm for Hüsler-Reiss models — hr-clusterpath"><meta name="description" content="Gradient descent based on the Clusterpath algorithm adapted to the likelihood
of a graphical Hüsler-Reiss model. Usefull when the precision matrix \(\Theta\)
(or the variogram \(\Gamma\)) has a block matrix structure."><meta property="og:description" content="Gradient descent based on the Clusterpath algorithm adapted to the likelihood
of a graphical Hüsler-Reiss model. Usefull when the precision matrix \(\Theta\)
(or the variogram \(\Gamma\)) has a block matrix structure."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HRClusterpath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clusterpath algorithm for Hüsler-Reiss models</h1>

      <div class="d-none name"><code>hr-clusterpath.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Gradient descent based on the Clusterpath algorithm adapted to the likelihood
of a graphical Hüsler-Reiss model. Usefull when the precision matrix \(\Theta\)
(or the variogram \(\Gamma\)) has a block matrix structure.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">HR_Clusterpath</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">zeta</span>,</span>
<span>  W <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eps_f <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kappa <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  eps_conv <span class="op">=</span> <span class="fl">1e-07</span>,</span>
<span>  tol_opt <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  iter_max <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A \(n \times d\) matrix : the matrix of data.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>If a positive number, the regularized parameter for the penalty. If a numerix
vector of positive number : the grid line for \(\lambda\).</p></dd>


<dt id="arg-zeta">zeta<a class="anchor" aria-label="anchor" href="#arg-zeta"></a></dt>
<dd><p>A positive number : tuned parameter for the exponential weights.
If <code>W</code> is not <code>NULL</code>, this parameter is not used.</p></dd>


<dt id="arg-w">W<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>A \(d \times d\) matrix of positive number : the weights for the penalty.
If <code>NULL</code> (default), it is set as the exponential weights, which depends of only one
tuning parameter \(\zeta\) and where we have some theoretical results.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>A numeric between 0 and 1, or <code>NULL</code>.  If <code>NULL</code> (default), it is
assumed that the data are already on multivariate Pareto scale. Else, <code>p</code> is used as the probability
in the function <code>data2mpareto()</code> to standardize the data (see <code>graphicalExtremes</code> documentation).</p></dd>


<dt id="arg-eps-f">eps_f<a class="anchor" aria-label="anchor" href="#arg-eps-f"></a></dt>
<dd><p>A positive number : tolerance threshold for merging clusters. If <code>NULL</code> (default),
it is set as \(\kappa\) times the median of the non-diagonal elements of the distance matrix
between the column of the initial \(\Theta\).</p></dd>


<dt id="arg-kappa">kappa<a class="anchor" aria-label="anchor" href="#arg-kappa"></a></dt>
<dd><p>A positive number : tuned parameter for the fusion threshold. If <code>eps_f</code> is not <code>NULL</code>,
this parameter is not used.</p></dd>


<dt id="arg-eps-conv">eps_conv<a class="anchor" aria-label="anchor" href="#arg-eps-conv"></a></dt>
<dd><p>A positive number : tolerance threshold for the convergence of the algorithm.</p></dd>


<dt id="arg-iter-max">iter_max<a class="anchor" aria-label="anchor" href="#arg-iter-max"></a></dt>
<dd><p>An integer : maximal number of iteration of the procedure.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>HR_Clusterpath()</code> is a block gradient descent from the data with default values and method for
the optimization : the variogram matrix \(\Gamma\) is the empirical variogram and the weights are
set as the exponential weights, which depends of only one tuning parameter \(\zeta\) and where
we have some theoretical results.</p>
<p>The produce a list of results :</p><ul><li><p>$R : the \(R\) matrix of the clusters.</p></li>
<li><p>$clusters : a list of the variable indices, clustered.</p></li>
<li><p>$likelihood : the value of the negative penalised negative loglikelihood.</p></li>
<li><p>$lambda : the value of lambda.</p></li>
<li><p>$inputs : a list of the input parameters used in the procedure.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The block matrix models is defined from two elements : the cluster's partition
\(\{C_1, \dots, C_K\}\), included in \(V\) and the \(R\) matrix which belongs
to \(\mathcal S_K(\mathbb R)\), the set of symmetric \(K \times K\) matrix (See also
<code>build_theta()</code> and <code><a href="theta-r.html">extract_R_matrix</a>()</code>).</p>
<p>The Clusterpath aims to find optimum of some penalised negative loglikelihood defined in
<code>neg_likelihood_pen()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="some-results-for-hr-clusterpath-">Some results for <code>HR_Clusterpath()</code><a class="anchor" aria-label="anchor" href="#some-results-for-hr-clusterpath-"></a></h2>



<p>When we get replications \(X_1, \dots, X_n\) of a random vector \(X\) which
belongs to the attraction domain of a \(K\)-block Hüsler-Reiss graphical model, the
minimum of the penalised negative loglikelihood conveges almost surely to the
true precision matrix of the model \(\Theta^*\), for all \(\lambda\), provided that
we choose a sequence \((\zeta_n)_{n\in \mathbb N^*}\) which grows slower than the
\(log(n)\) sequence. In general, the \(\zeta \in [1,2]\) is a good choice.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">############################################################################</span></span></span>
<span class="r-in"><span><span class="co">#                            With get_clusters</span></span></span>
<span class="r-in"><span><span class="co">############################################################################</span></span></span>
<span class="r-in"><span><span class="co"># Customizable weights</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, nc <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Free choice of variogram</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu">graphicalExtremes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graphicalExtremes/man/generate_random_Gamma.html" class="external-link">generate_random_Gamma</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Choice of initial condition for the optimization</span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>              <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>              <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, nc <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">2.2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################################################################</span></span></span>
<span class="r-in"><span><span class="co">#                            With HR_Clusterpath</span></span></span>
<span class="r-in"><span><span class="co">############################################################################</span></span></span>
<span class="r-in"><span><span class="co"># Construction of clusters and R matrix for simulation</span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>              <span class="op">-</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>              <span class="fl">0</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, nc <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Construction of induced theta and corresponding variogram gamma</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="theta-r.html">build_Theta</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu">graphicalExtremes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graphicalExtremes/man/parameterMatrixConversion.html" class="external-link">Theta2Gamma</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gr3_bal_sim_param_cluster</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    R <span class="op">=</span> <span class="va">R</span>,</span></span>
<span class="r-in"><span>    clusters <span class="op">=</span> <span class="va">clusters</span>,</span></span>
<span class="r-in"><span>    Theta <span class="op">=</span> <span class="va">Theta</span>,</span></span>
<span class="r-in"><span>    Gamma <span class="op">=</span> <span class="va">Gamma</span>,</span></span>
<span class="r-in"><span>    chi <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fl">1e3</span>,</span></span>
<span class="r-in"><span>    d <span class="op">=</span> <span class="fl">15</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexandre CAPEL.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

